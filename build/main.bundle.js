!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pin=document.querySelector("template").content.querySelector(".map__pin").cloneNode(!0),this.pin.style.left=t.location.x-this.pin.offsetWidth/2+"px",this.pin.style.top=t.location.y-this.pin.offsetHeight+"px",this.avatar=this.pin.querySelector("img"),this.avatar.src=t.author.avatar,this.avatar.alt=t.offer.tittle}var t,n,i;return t=e,(n=[{key:"render",value:function(){return this.pin.setAttribute("tabindex","0"),this.pin}}])&&r(t.prototype,n),i&&r(t,i),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a={palace:"Дворец",flat:"Квартира",house:"Дом",bungalo:"Бунгало"},s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.card=document.querySelector("template").content.querySelector(".map__card").cloneNode(!0),this.title=this.fillElem(".popup__tittle","textContent",t.offer.tittle),this.adress=this.fillElem(".popup__text--address","textContent",t.offer.address),this.price=this.fillElem(".popup__price","textContent","".concat(t.offer.price," ₽ /ночь")),this.type=this.fillElem(".popup__type","textContent",a[t.offer.type]),this.capacity=this.fillElem(".popup__text--capacity","textContent","Количество комнат:  ".concat(obj.offer.rooms,", количество гостей: ").concat(obj.offer.guests)),this.time=this.fillElem(".popup__text--time","textContent","Заезд после ".concat(obj.offer.checkin,", выезд до ").concat(obj.offer.checkout)),this.features=this.card.querySelector(".popup__features"),this.features.innerHTML+=t.offer.features.forEach(function(e){return list+='<li class="feature feature--'.concat(e,"></li>")}),this.description=this.fillElem(".popup__description","textContent",t.offer.description),this.pictures=this.card.querySelector(".popup__pictures"),this.pictures.innerHTML+=t.offer.photos.forEach(function(e){return'<li><img src="'.concat(e,'"></li>')}),this.avatar=this.fillElem(".popup__avatar","src",t.author.avatar),this.close=this.card.querySelector(".popup__close"),this.closeKeydownHandler=this.closeKeydownHandler.bind(this)}var t,n,r;return t=e,(n=[{key:"fillElem",value:function(e,t,n){this.card.querySelector(e)[t]=n}},{key:"render",value:function(){var e=this;document.addEventListener("keydown",closeKeydownHandler),this.close.addEventListener("click",function(t){t.preventDefault(),e.closeHandler()})}},{key:"closeHandler",value:function(){this.card.classList.add("hidden")}},{key:"closeKeydownHandler",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e.preventDefault(),"Escape"===e.code&&(this.closeHandler(),document.removeEventListener("keydown",closeKeydownHandler))})}])&&o(t.prototype,n),r&&o(t,r),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.error=document.querySelector(".form__error"),this.error.querySelector("button").addEventListener("click",function(e){e.preventDefault(),t.error.style.display="none"}),this.error.querySelector("button").addEventListener("keydown",function(e){e.preventDefault(),"Enter"===e.code&&(t.error.style.display="none")})}var t,n,r;return t=e,(n=[{key:"render",value:function(e){this.error.querySelector("p").textContent=e,this.error.style.display="block"}}])&&c(t.prototype,n),r&&c(t,r),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f={type:document.querySelector("#housing-type"),rooms:document.querySelector("#housing-rooms"),guests:document.querySelector("#housing-guests"),prices:document.querySelector("#housing-price"),features:document.querySelector("#housing-features").elements},h=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arr=t,this.arr=this.filterDefault("type",f.type.value),this.arr=this.filterDefault("rooms",f.rooms.value),this.arr=this.filterDefault("guests",f.guests.value),this.arr=this.feature(this.price()),this.arr}var t,n,r;return t=e,(n=[{key:"filterDefault",value:function(e,t){return"any"===t?this.arr:this.arr.filter(function(n){return n.offer[e]==t})}},{key:"filterPrice",value:function(){var e=this;return"any"===this.prices.value?this.arr:this.arr.filter(function(t){switch(e.prices.value){case"low":return t.offer.price<1e4;case"middle":return t.offer.price>=1e4&&t.offer.price<5e4;case"high":return t.offer.price>=5e4}})}},{key:"filterFeatures",value:function(){var e=[];return this.features.forEach(function(t){t.checked&&e.push(t.value)}),this.arr.filter(function(t){return e.every(function(e){return t.offer.features.includes(e)})})}}])&&u(t.prototype,n),r&&u(t,r),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p,m,v=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rooms=document.querySelector("#room_number"),this.capacity=document.querySelector("#capacity"),this.validate=new Event("validate"),this.capacity.onmousedown=this.rooms.onmousedown=function(){t.capacity.onchange=function(){t.validateMain(t.capacity,t.rooms)},t.rooms.onchange=function(){t.validateMain(t.rooms,t.capacity)}},this.capacity.addEventListener("validate",function(){onCustomValidation(t.capacity)}),this.rooms.addEventListener("validate",function(){onCustomValidation(t.rooms)})}var t,n,r;return t=e,(n=[{key:"checkRoomNumber",value:function(e,t,n){if(e!==t){var r="Вы не можете выбрать ".concat(t," гостей для ").concat(e," комнат");100==e&&0==t||3==e&&0!=t||2==e&&(t<3||t>0)?(n.style.borderColor="#eee",n.setCustomValidity("")):(n.style.borderColor="#ff5635",n.setCustomValidity(r))}else n.style.borderColor="#eee",n.setCustomValidity("")}},{key:"validateRelative",value:function(e){this.checkRoomNumber(this.rooms.value,this.capacity.value,e),e.onchange=null}},{key:"validateMain",value:function(e,t){this.checkRoomNumber(this.rooms.value,this.capacity.value,e);var n=new Event("validate");t.dispatchEvent(n)}}])&&d(t.prototype,n),r&&d(t,r),e}();function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elem=t,this.field=n,this.address=document.querySelector("#address"),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.elem.addEventListener("mousedown",this.onMouseDown)}var t,n,r;return t=e,(n=[{key:"onMouseUp",value:function(e){var t=this;if(e.preventDefault(),this.address.value="".concat((this.elem.getBoundingClientRect().left-this.elem.offsetWidth/2).toFixed(0),", ").concat((this.elem.getBoundingClientRect().bottom+window.pageYOffset).toFixed(0)),document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),p){this.elem.addEventListener("click",function e(n){n.preventDefault(),t.elem.removeEventListener("click",e)})}}},{key:"onMouseDown",value:function(e){m={x:e.clientX,y:e.clientY},p=!1,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}},{key:"onMouseMove",value:function(e){e.preventDefault(),p=!0;var t=m.x-e.clientX,n=m.y-e.clientY;m={x:e.clientX,y:e.clientY},this.elem.style.top=this.elem.offsetTop-n+"px",parseInt(this.elem.style.top)<0+this.elem.clientHeight/2&&(this.elem.style.top=0+this.elem.clientHeight/2+"px"),parseInt(mainPin.style.top)>this.field.clientHeight-this.elem.clientHeight&&(this.elem.style.top=this.field.clientHeight-this.elem.clientHeight+"px"),this.elem.style.left=this.elem.offsetLeft-t+"px",parseInt(this.elem.style.left)<0+this.elem.clientWidth/2&&(this.elem.style.left=0+this.elem.clientWidth/2+"px"),parseInt(this.elem.style.left)>this.field.clientWidth-this.elem.clientWidth/2&&(this.elem.style.left=this.field.clientWidth-this.elem.clientWidth/2+"px")}}])&&y(t.prototype,n),r&&y(t,r),e}();function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}var _=function(){var e,t=(e=regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,n);case 3:return r=e.sent,e.abrupt("return",r.json());case 7:throw e.prev=7,e.t0=e.catch(0),new Error("Не удалось загрузить объявления. Ошибка ".concat(e.t0.message,". Попробуйте перезагрузить страницу."));case 10:case"end":return e.stop()}},e,null,[[0,7]])}),function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){w(o,r,i,a,s,"next",e)}function s(e){w(o,r,i,a,s,"throw",e)}a(void 0)})});return function(e,n){return t.apply(this,arguments)}}(),E={flat:"1000",house:"5000",bungalo:"0",palace:"10000"};new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=document.querySelector(".map"),this.pins=document.querySelector(".map__pins"),this.filters=document.querySelector(".map__filters-container"),this.mainPin=this.pins.querySelector(".map__pin--main"),this.mainPin.addEventListener("mouseup",this.render),this.notice=document.querySelector(".notice__form"),this.address=this.notice.querySelector("#address"),this.type=document.querySelector("#type"),this.price=document.querySelector("#price"),this.render=this.render.bind(this),this._isCard=!1}var t,n,r;return t=e,(n=[{key:"render",value:function(){var e=this;this.map.classList.remove("map--faded"),this.notice.classList.remove("notice__form--disabled"),this.mainPin.addEventListener("click",function(){mainPin.removeEventListener("mouseup",e.render)}),this.address.value="".concat((this.mainPin.getBoundingClientRect().left-this.mainPin.offsetWidth/2).toFixed(0),", ").concat((this.mainPin.getBoundingClientRect().bottom+window.pageYOffset).toFixed(0)),document.querySelectorAll("fieldset").forEach(function(e){return e.disabled=!1}),this._isCard?this.map.replaceChild(this.map.querySelector(".map__card"),(new s).render()):(this.map.insertBefore((new s).render(),this.filters),this._isCard=!0),new v;var t=new l;this.map.querySelectorAll(".map__pin:not(.map__pin--main)").forEach(function(e){return e.remove()}),new b(this.mainPin,this.map);var n=document.createDocumentFragment(),r=this.backend("https://js.dump.academy/keksobooking/data",{},t);r.forEach(function(e){return n.appendChild(pinHandler(new i(e).render()))}),function e(t,n){var r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;c instanceof"HTMLCollection"?e(c):c.addEventListener("change",function(){new h(n)})}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}(f,r),this.type.addEventListener("change",function(){e.price.setAttribute("min",E[e.type.value]),e.price.setAttribute("placeholder",E[e.type.value])}),this.pins.appendChild(n)}},{key:"pinHandler",value:function(e){var t=this;return e.addEventListener("click",function(){t.map.replaceChild(t.map.querySelector(".map__card"),(new s).render())}),e.addEventListener("keydown",function(e){e.preventDefault(),t.map.replaceChild(t.map.querySelector(".map__card"),(new s).render())}),e}},{key:"backend",value:function(e,t,n){return _(e,t).catch(function(e){return n.render("Не удалось загрузить объявления. Ошибка ".concat(e.message,". Попробуйте перезагрузить страницу."))})}}])&&g(t.prototype,n),r&&g(t,r),e}())}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5idW5kbGUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbWFpbi5idW5kbGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiIWZ1bmN0aW9uKGUpe3ZhciB0PXt9O2Z1bmN0aW9uIG4ocil7aWYodFtyXSlyZXR1cm4gdFtyXS5leHBvcnRzO3ZhciBpPXRbcl09e2k6cixsOiExLGV4cG9ydHM6e319O3JldHVybiBlW3JdLmNhbGwoaS5leHBvcnRzLGksaS5leHBvcnRzLG4pLGkubD0hMCxpLmV4cG9ydHN9bi5tPWUsbi5jPXQsbi5kPWZ1bmN0aW9uKGUsdCxyKXtuLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7ZW51bWVyYWJsZTohMCxnZXQ6cn0pfSxuLnI9ZnVuY3Rpb24oZSl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOlwiTW9kdWxlXCJ9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0sbi50PWZ1bmN0aW9uKGUsdCl7aWYoMSZ0JiYoZT1uKGUpKSw4JnQpcmV0dXJuIGU7aWYoNCZ0JiZcIm9iamVjdFwiPT10eXBlb2YgZSYmZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciByPU9iamVjdC5jcmVhdGUobnVsbCk7aWYobi5yKHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiZGVmYXVsdFwiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOmV9KSwyJnQmJlwic3RyaW5nXCIhPXR5cGVvZiBlKWZvcih2YXIgaSBpbiBlKW4uZChyLGksZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19LmJpbmQobnVsbCxpKSk7cmV0dXJuIHJ9LG4ubj1mdW5jdGlvbihlKXt2YXIgdD1lJiZlLl9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiBlfTtyZXR1cm4gbi5kKHQsXCJhXCIsdCksdH0sbi5vPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfSxuLnA9XCJcIixuKG4ucz0wKX0oW2Z1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX1uLnIodCk7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpeyFmdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9KHRoaXMsZSksdGhpcy5waW49ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInRlbXBsYXRlXCIpLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5tYXBfX3BpblwiKS5jbG9uZU5vZGUoITApLHRoaXMucGluLnN0eWxlLmxlZnQ9dC5sb2NhdGlvbi54LXRoaXMucGluLm9mZnNldFdpZHRoLzIrXCJweFwiLHRoaXMucGluLnN0eWxlLnRvcD10LmxvY2F0aW9uLnktdGhpcy5waW4ub2Zmc2V0SGVpZ2h0K1wicHhcIix0aGlzLmF2YXRhcj10aGlzLnBpbi5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpLHRoaXMuYXZhdGFyLnNyYz10LmF1dGhvci5hdmF0YXIsdGhpcy5hdmF0YXIuYWx0PXQub2ZmZXIudGl0dGxlfXZhciB0LG4saTtyZXR1cm4gdD1lLChuPVt7a2V5OlwicmVuZGVyXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5waW4uc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIixcIjBcIiksdGhpcy5waW59fV0pJiZyKHQucHJvdG90eXBlLG4pLGkmJnIodCxpKSxlfSgpO2Z1bmN0aW9uIG8oZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiByJiYoci53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsci5rZXkscil9fXZhciBhPXtwYWxhY2U6XCLQlNCy0L7RgNC10YZcIixmbGF0Olwi0JrQstCw0YDRgtC40YDQsFwiLGhvdXNlOlwi0JTQvtC8XCIsYnVuZ2FsbzpcItCR0YPQvdCz0LDQu9C+XCJ9LHM9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpeyFmdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9KHRoaXMsZSksdGhpcy5jYXJkPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJ0ZW1wbGF0ZVwiKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFwX19jYXJkXCIpLmNsb25lTm9kZSghMCksdGhpcy50aXRsZT10aGlzLmZpbGxFbGVtKFwiLnBvcHVwX190aXR0bGVcIixcInRleHRDb250ZW50XCIsdC5vZmZlci50aXR0bGUpLHRoaXMuYWRyZXNzPXRoaXMuZmlsbEVsZW0oXCIucG9wdXBfX3RleHQtLWFkZHJlc3NcIixcInRleHRDb250ZW50XCIsdC5vZmZlci5hZGRyZXNzKSx0aGlzLnByaWNlPXRoaXMuZmlsbEVsZW0oXCIucG9wdXBfX3ByaWNlXCIsXCJ0ZXh0Q29udGVudFwiLFwiXCIuY29uY2F0KHQub2ZmZXIucHJpY2UsXCIg4oK9IC/QvdC+0YfRjFwiKSksdGhpcy50eXBlPXRoaXMuZmlsbEVsZW0oXCIucG9wdXBfX3R5cGVcIixcInRleHRDb250ZW50XCIsYVt0Lm9mZmVyLnR5cGVdKSx0aGlzLmNhcGFjaXR5PXRoaXMuZmlsbEVsZW0oXCIucG9wdXBfX3RleHQtLWNhcGFjaXR5XCIsXCJ0ZXh0Q29udGVudFwiLFwi0JrQvtC70LjRh9C10YHRgtCy0L4g0LrQvtC80L3QsNGCOiAgXCIuY29uY2F0KG9iai5vZmZlci5yb29tcyxcIiwg0LrQvtC70LjRh9C10YHRgtCy0L4g0LPQvtGB0YLQtdC5OiBcIikuY29uY2F0KG9iai5vZmZlci5ndWVzdHMpKSx0aGlzLnRpbWU9dGhpcy5maWxsRWxlbShcIi5wb3B1cF9fdGV4dC0tdGltZVwiLFwidGV4dENvbnRlbnRcIixcItCX0LDQtdC30LQg0L/QvtGB0LvQtSBcIi5jb25jYXQob2JqLm9mZmVyLmNoZWNraW4sXCIsINCy0YvQtdC30LQg0LTQviBcIikuY29uY2F0KG9iai5vZmZlci5jaGVja291dCkpLHRoaXMuZmVhdHVyZXM9dGhpcy5jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ZlYXR1cmVzXCIpLHRoaXMuZmVhdHVyZXMuaW5uZXJIVE1MKz10Lm9mZmVyLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24oZSl7cmV0dXJuIGxpc3QrPSc8bGkgY2xhc3M9XCJmZWF0dXJlIGZlYXR1cmUtLScuY29uY2F0KGUsXCI+PC9saT5cIil9KSx0aGlzLmRlc2NyaXB0aW9uPXRoaXMuZmlsbEVsZW0oXCIucG9wdXBfX2Rlc2NyaXB0aW9uXCIsXCJ0ZXh0Q29udGVudFwiLHQub2ZmZXIuZGVzY3JpcHRpb24pLHRoaXMucGljdHVyZXM9dGhpcy5jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3BpY3R1cmVzXCIpLHRoaXMucGljdHVyZXMuaW5uZXJIVE1MKz10Lm9mZmVyLnBob3Rvcy5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybic8bGk+PGltZyBzcmM9XCInLmNvbmNhdChlLCdcIj48L2xpPicpfSksdGhpcy5hdmF0YXI9dGhpcy5maWxsRWxlbShcIi5wb3B1cF9fYXZhdGFyXCIsXCJzcmNcIix0LmF1dGhvci5hdmF0YXIpLHRoaXMuY2xvc2U9dGhpcy5jYXJkLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpLHRoaXMuY2xvc2VLZXlkb3duSGFuZGxlcj10aGlzLmNsb3NlS2V5ZG93bkhhbmRsZXIuYmluZCh0aGlzKX12YXIgdCxuLHI7cmV0dXJuIHQ9ZSwobj1be2tleTpcImZpbGxFbGVtXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3RoaXMuY2FyZC5xdWVyeVNlbGVjdG9yKGUpW3RdPW59fSx7a2V5OlwicmVuZGVyXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsY2xvc2VLZXlkb3duSGFuZGxlciksdGhpcy5jbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCksZS5jbG9zZUhhbmRsZXIoKX0pfX0se2tleTpcImNsb3NlSGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5jYXJkLmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIil9fSx7a2V5OlwiY2xvc2VLZXlkb3duSGFuZGxlclwiLHZhbHVlOmZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCl7cmV0dXJuIGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiB0LnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGUudG9TdHJpbmcoKX0sdH0oZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpLFwiRXNjYXBlXCI9PT1lLmNvZGUmJih0aGlzLmNsb3NlSGFuZGxlcigpLGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsY2xvc2VLZXlkb3duSGFuZGxlcikpfSl9XSkmJm8odC5wcm90b3R5cGUsbiksciYmbyh0LHIpLGV9KCk7ZnVuY3Rpb24gYyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19dmFyIGw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dmFyIHQ9dGhpczshZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMuZXJyb3I9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19lcnJvclwiKSx0aGlzLmVycm9yLnF1ZXJ5U2VsZWN0b3IoXCJidXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24oZSl7ZS5wcmV2ZW50RGVmYXVsdCgpLHQuZXJyb3Iuc3R5bGUuZGlzcGxheT1cIm5vbmVcIn0pLHRoaXMuZXJyb3IucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLGZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxcIkVudGVyXCI9PT1lLmNvZGUmJih0LmVycm9yLnN0eWxlLmRpc3BsYXk9XCJub25lXCIpfSl9dmFyIHQsbixyO3JldHVybiB0PWUsKG49W3trZXk6XCJyZW5kZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmVycm9yLnF1ZXJ5U2VsZWN0b3IoXCJwXCIpLnRleHRDb250ZW50PWUsdGhpcy5lcnJvci5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIn19XSkmJmModC5wcm90b3R5cGUsbiksciYmYyh0LHIpLGV9KCk7ZnVuY3Rpb24gdShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19dmFyIGY9e3R5cGU6ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNob3VzaW5nLXR5cGVcIikscm9vbXM6ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNob3VzaW5nLXJvb21zXCIpLGd1ZXN0czpkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2hvdXNpbmctZ3Vlc3RzXCIpLHByaWNlczpkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2hvdXNpbmctcHJpY2VcIiksZmVhdHVyZXM6ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNob3VzaW5nLWZlYXR1cmVzXCIpLmVsZW1lbnRzfSxoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtyZXR1cm4gZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMuYXJyPXQsdGhpcy5hcnI9dGhpcy5maWx0ZXJEZWZhdWx0KFwidHlwZVwiLGYudHlwZS52YWx1ZSksdGhpcy5hcnI9dGhpcy5maWx0ZXJEZWZhdWx0KFwicm9vbXNcIixmLnJvb21zLnZhbHVlKSx0aGlzLmFycj10aGlzLmZpbHRlckRlZmF1bHQoXCJndWVzdHNcIixmLmd1ZXN0cy52YWx1ZSksdGhpcy5hcnI9dGhpcy5mZWF0dXJlKHRoaXMucHJpY2UoKSksdGhpcy5hcnJ9dmFyIHQsbixyO3JldHVybiB0PWUsKG49W3trZXk6XCJmaWx0ZXJEZWZhdWx0XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm5cImFueVwiPT09dD90aGlzLmFycjp0aGlzLmFyci5maWx0ZXIoZnVuY3Rpb24obil7cmV0dXJuIG4ub2ZmZXJbZV09PXR9KX19LHtrZXk6XCJmaWx0ZXJQcmljZVwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm5cImFueVwiPT09dGhpcy5wcmljZXMudmFsdWU/dGhpcy5hcnI6dGhpcy5hcnIuZmlsdGVyKGZ1bmN0aW9uKHQpe3N3aXRjaChlLnByaWNlcy52YWx1ZSl7Y2FzZVwibG93XCI6cmV0dXJuIHQub2ZmZXIucHJpY2U8MWU0O2Nhc2VcIm1pZGRsZVwiOnJldHVybiB0Lm9mZmVyLnByaWNlPj0xZTQmJnQub2ZmZXIucHJpY2U8NWU0O2Nhc2VcImhpZ2hcIjpyZXR1cm4gdC5vZmZlci5wcmljZT49NWU0fX0pfX0se2tleTpcImZpbHRlckZlYXR1cmVzXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdGhpcy5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuY2hlY2tlZCYmZS5wdXNoKHQudmFsdWUpfSksdGhpcy5hcnIuZmlsdGVyKGZ1bmN0aW9uKHQpe3JldHVybiBlLmV2ZXJ5KGZ1bmN0aW9uKGUpe3JldHVybiB0Lm9mZmVyLmZlYXR1cmVzLmluY2x1ZGVzKGUpfSl9KX19XSkmJnUodC5wcm90b3R5cGUsbiksciYmdSh0LHIpLGV9KCk7ZnVuY3Rpb24gZChlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19dmFyIHAsbSx2PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3ZhciB0PXRoaXM7IWZ1bmN0aW9uKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX0odGhpcyxlKSx0aGlzLnJvb21zPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcm9vbV9udW1iZXJcIiksdGhpcy5jYXBhY2l0eT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcGFjaXR5XCIpLHRoaXMudmFsaWRhdGU9bmV3IEV2ZW50KFwidmFsaWRhdGVcIiksdGhpcy5jYXBhY2l0eS5vbm1vdXNlZG93bj10aGlzLnJvb21zLm9ubW91c2Vkb3duPWZ1bmN0aW9uKCl7dC5jYXBhY2l0eS5vbmNoYW5nZT1mdW5jdGlvbigpe3QudmFsaWRhdGVNYWluKHQuY2FwYWNpdHksdC5yb29tcyl9LHQucm9vbXMub25jaGFuZ2U9ZnVuY3Rpb24oKXt0LnZhbGlkYXRlTWFpbih0LnJvb21zLHQuY2FwYWNpdHkpfX0sdGhpcy5jYXBhY2l0eS5hZGRFdmVudExpc3RlbmVyKFwidmFsaWRhdGVcIixmdW5jdGlvbigpe29uQ3VzdG9tVmFsaWRhdGlvbih0LmNhcGFjaXR5KX0pLHRoaXMucm9vbXMuYWRkRXZlbnRMaXN0ZW5lcihcInZhbGlkYXRlXCIsZnVuY3Rpb24oKXtvbkN1c3RvbVZhbGlkYXRpb24odC5yb29tcyl9KX12YXIgdCxuLHI7cmV0dXJuIHQ9ZSwobj1be2tleTpcImNoZWNrUm9vbU51bWJlclwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtpZihlIT09dCl7dmFyIHI9XCLQktGLINC90LUg0LzQvtC20LXRgtC1INCy0YvQsdGA0LDRgtGMIFwiLmNvbmNhdCh0LFwiINCz0L7RgdGC0LXQuSDQtNC70Y8gXCIpLmNvbmNhdChlLFwiINC60L7QvNC90LDRglwiKTsxMDA9PWUmJjA9PXR8fDM9PWUmJjAhPXR8fDI9PWUmJih0PDN8fHQ+MCk/KG4uc3R5bGUuYm9yZGVyQ29sb3I9XCIjZWVlXCIsbi5zZXRDdXN0b21WYWxpZGl0eShcIlwiKSk6KG4uc3R5bGUuYm9yZGVyQ29sb3I9XCIjZmY1NjM1XCIsbi5zZXRDdXN0b21WYWxpZGl0eShyKSl9ZWxzZSBuLnN0eWxlLmJvcmRlckNvbG9yPVwiI2VlZVwiLG4uc2V0Q3VzdG9tVmFsaWRpdHkoXCJcIil9fSx7a2V5OlwidmFsaWRhdGVSZWxhdGl2ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuY2hlY2tSb29tTnVtYmVyKHRoaXMucm9vbXMudmFsdWUsdGhpcy5jYXBhY2l0eS52YWx1ZSxlKSxlLm9uY2hhbmdlPW51bGx9fSx7a2V5OlwidmFsaWRhdGVNYWluXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLmNoZWNrUm9vbU51bWJlcih0aGlzLnJvb21zLnZhbHVlLHRoaXMuY2FwYWNpdHkudmFsdWUsZSk7dmFyIG49bmV3IEV2ZW50KFwidmFsaWRhdGVcIik7dC5kaXNwYXRjaEV2ZW50KG4pfX1dKSYmZCh0LnByb3RvdHlwZSxuKSxyJiZkKHQsciksZX0oKTtmdW5jdGlvbiB5KGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX12YXIgYj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXshZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMuZWxlbT10LHRoaXMuZmllbGQ9bix0aGlzLmFkZHJlc3M9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGRyZXNzXCIpLHRoaXMub25Nb3VzZURvd249dGhpcy5vbk1vdXNlRG93bi5iaW5kKHRoaXMpLHRoaXMub25Nb3VzZU1vdmU9dGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpLHRoaXMub25Nb3VzZVVwPXRoaXMub25Nb3VzZVVwLmJpbmQodGhpcyksdGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIix0aGlzLm9uTW91c2VEb3duKX12YXIgdCxuLHI7cmV0dXJuIHQ9ZSwobj1be2tleTpcIm9uTW91c2VVcFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXM7aWYoZS5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYWRkcmVzcy52YWx1ZT1cIlwiLmNvbmNhdCgodGhpcy5lbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQtdGhpcy5lbGVtLm9mZnNldFdpZHRoLzIpLnRvRml4ZWQoMCksXCIsIFwiKS5jb25jYXQoKHRoaXMuZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20rd2luZG93LnBhZ2VZT2Zmc2V0KS50b0ZpeGVkKDApKSxkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsdGhpcy5vbk1vdXNlTW92ZSksZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIix0aGlzLm9uTW91c2VVcCkscCl7dGhpcy5lbGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLGZ1bmN0aW9uIGUobil7bi5wcmV2ZW50RGVmYXVsdCgpLHQuZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIixlKX0pfX19LHtrZXk6XCJvbk1vdXNlRG93blwiLHZhbHVlOmZ1bmN0aW9uKGUpe209e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfSxwPSExLGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIix0aGlzLm9uTW91c2VNb3ZlKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLHRoaXMub25Nb3VzZVVwKX19LHtrZXk6XCJvbk1vdXNlTW92ZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSxwPSEwO3ZhciB0PW0ueC1lLmNsaWVudFgsbj1tLnktZS5jbGllbnRZO209e3g6ZS5jbGllbnRYLHk6ZS5jbGllbnRZfSx0aGlzLmVsZW0uc3R5bGUudG9wPXRoaXMuZWxlbS5vZmZzZXRUb3AtbitcInB4XCIscGFyc2VJbnQodGhpcy5lbGVtLnN0eWxlLnRvcCk8MCt0aGlzLmVsZW0uY2xpZW50SGVpZ2h0LzImJih0aGlzLmVsZW0uc3R5bGUudG9wPTArdGhpcy5lbGVtLmNsaWVudEhlaWdodC8yK1wicHhcIikscGFyc2VJbnQobWFpblBpbi5zdHlsZS50b3ApPnRoaXMuZmllbGQuY2xpZW50SGVpZ2h0LXRoaXMuZWxlbS5jbGllbnRIZWlnaHQmJih0aGlzLmVsZW0uc3R5bGUudG9wPXRoaXMuZmllbGQuY2xpZW50SGVpZ2h0LXRoaXMuZWxlbS5jbGllbnRIZWlnaHQrXCJweFwiKSx0aGlzLmVsZW0uc3R5bGUubGVmdD10aGlzLmVsZW0ub2Zmc2V0TGVmdC10K1wicHhcIixwYXJzZUludCh0aGlzLmVsZW0uc3R5bGUubGVmdCk8MCt0aGlzLmVsZW0uY2xpZW50V2lkdGgvMiYmKHRoaXMuZWxlbS5zdHlsZS5sZWZ0PTArdGhpcy5lbGVtLmNsaWVudFdpZHRoLzIrXCJweFwiKSxwYXJzZUludCh0aGlzLmVsZW0uc3R5bGUubGVmdCk+dGhpcy5maWVsZC5jbGllbnRXaWR0aC10aGlzLmVsZW0uY2xpZW50V2lkdGgvMiYmKHRoaXMuZWxlbS5zdHlsZS5sZWZ0PXRoaXMuZmllbGQuY2xpZW50V2lkdGgtdGhpcy5lbGVtLmNsaWVudFdpZHRoLzIrXCJweFwiKX19XSkmJnkodC5wcm90b3R5cGUsbiksciYmeSh0LHIpLGV9KCk7ZnVuY3Rpb24gZyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19ZnVuY3Rpb24gdyhlLHQsbixyLGksbyxhKXt0cnl7dmFyIHM9ZVtvXShhKSxjPXMudmFsdWV9Y2F0Y2goZSl7cmV0dXJuIHZvaWQgbihlKX1zLmRvbmU/dChjKTpQcm9taXNlLnJlc29sdmUoYykudGhlbihyLGkpfXZhciBfPWZ1bmN0aW9uKCl7dmFyIGUsdD0oZT1yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBlKHQsbil7dmFyIHI7cmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uKGUpe2Zvcig7Oylzd2l0Y2goZS5wcmV2PWUubmV4dCl7Y2FzZSAwOnJldHVybiBlLnByZXY9MCxlLm5leHQ9MyxmZXRjaCh0LG4pO2Nhc2UgMzpyZXR1cm4gcj1lLnNlbnQsZS5hYnJ1cHQoXCJyZXR1cm5cIixyLmpzb24oKSk7Y2FzZSA3OnRocm93IGUucHJldj03LGUudDA9ZS5jYXRjaCgwKSxuZXcgRXJyb3IoXCLQndC1INGD0LTQsNC70L7RgdGMINC30LDQs9GA0YPQt9C40YLRjCDQvtCx0YrRj9Cy0LvQtdC90LjRjy4g0J7RiNC40LHQutCwIFwiLmNvbmNhdChlLnQwLm1lc3NhZ2UsXCIuINCf0L7Qv9GA0L7QsdGD0LnRgtC1INC/0LXRgNC10LfQsNCz0YDRg9C30LjRgtGMINGB0YLRgNCw0L3QuNGG0YMuXCIpKTtjYXNlIDEwOmNhc2VcImVuZFwiOnJldHVybiBlLnN0b3AoKX19LGUsbnVsbCxbWzAsN11dKX0pLGZ1bmN0aW9uKCl7dmFyIHQ9dGhpcyxuPWFyZ3VtZW50cztyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocixpKXt2YXIgbz1lLmFwcGx5KHQsbik7ZnVuY3Rpb24gYShlKXt3KG8scixpLGEscyxcIm5leHRcIixlKX1mdW5jdGlvbiBzKGUpe3cobyxyLGksYSxzLFwidGhyb3dcIixlKX1hKHZvaWQgMCl9KX0pO3JldHVybiBmdW5jdGlvbihlLG4pe3JldHVybiB0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX19KCksRT17ZmxhdDpcIjEwMDBcIixob3VzZTpcIjUwMDBcIixidW5nYWxvOlwiMFwiLHBhbGFjZTpcIjEwMDAwXCJ9O25ldyhmdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXshZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMubWFwPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFwXCIpLHRoaXMucGlucz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1hcF9fcGluc1wiKSx0aGlzLmZpbHRlcnM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYXBfX2ZpbHRlcnMtY29udGFpbmVyXCIpLHRoaXMubWFpblBpbj10aGlzLnBpbnMucXVlcnlTZWxlY3RvcihcIi5tYXBfX3Bpbi0tbWFpblwiKSx0aGlzLm1haW5QaW4uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIix0aGlzLnJlbmRlciksdGhpcy5ub3RpY2U9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ub3RpY2VfX2Zvcm1cIiksdGhpcy5hZGRyZXNzPXRoaXMubm90aWNlLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkcmVzc1wiKSx0aGlzLnR5cGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0eXBlXCIpLHRoaXMucHJpY2U9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmljZVwiKSx0aGlzLnJlbmRlcj10aGlzLnJlbmRlci5iaW5kKHRoaXMpLHRoaXMuX2lzQ2FyZD0hMX12YXIgdCxuLHI7cmV0dXJuIHQ9ZSwobj1be2tleTpcInJlbmRlclwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLm1hcC5jbGFzc0xpc3QucmVtb3ZlKFwibWFwLS1mYWRlZFwiKSx0aGlzLm5vdGljZS5jbGFzc0xpc3QucmVtb3ZlKFwibm90aWNlX19mb3JtLS1kaXNhYmxlZFwiKSx0aGlzLm1haW5QaW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsZnVuY3Rpb24oKXttYWluUGluLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsZS5yZW5kZXIpfSksdGhpcy5hZGRyZXNzLnZhbHVlPVwiXCIuY29uY2F0KCh0aGlzLm1haW5QaW4uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdC10aGlzLm1haW5QaW4ub2Zmc2V0V2lkdGgvMikudG9GaXhlZCgwKSxcIiwgXCIpLmNvbmNhdCgodGhpcy5tYWluUGluLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSt3aW5kb3cucGFnZVlPZmZzZXQpLnRvRml4ZWQoMCkpLGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJmaWVsZHNldFwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiBlLmRpc2FibGVkPSExfSksdGhpcy5faXNDYXJkP3RoaXMubWFwLnJlcGxhY2VDaGlsZCh0aGlzLm1hcC5xdWVyeVNlbGVjdG9yKFwiLm1hcF9fY2FyZFwiKSwobmV3IHMpLnJlbmRlcigpKToodGhpcy5tYXAuaW5zZXJ0QmVmb3JlKChuZXcgcykucmVuZGVyKCksdGhpcy5maWx0ZXJzKSx0aGlzLl9pc0NhcmQ9ITApLG5ldyB2O3ZhciB0PW5ldyBsO3RoaXMubWFwLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWFwX19waW46bm90KC5tYXBfX3Bpbi0tbWFpbilcIikuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gZS5yZW1vdmUoKX0pLG5ldyBiKHRoaXMubWFpblBpbix0aGlzLm1hcCk7dmFyIG49ZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHI9dGhpcy5iYWNrZW5kKFwiaHR0cHM6Ly9qcy5kdW1wLmFjYWRlbXkva2Vrc29ib29raW5nL2RhdGFcIix7fSx0KTtyLmZvckVhY2goZnVuY3Rpb24oZSl7cmV0dXJuIG4uYXBwZW5kQ2hpbGQocGluSGFuZGxlcihuZXcgaShlKS5yZW5kZXIoKSkpfSksZnVuY3Rpb24gZSh0LG4pe3ZhciByPSEwLGk9ITEsbz12b2lkIDA7dHJ5e2Zvcih2YXIgYSxzPXRbU3ltYm9sLml0ZXJhdG9yXSgpOyEocj0oYT1zLm5leHQoKSkuZG9uZSk7cj0hMCl7dmFyIGM9YS52YWx1ZTtjIGluc3RhbmNlb2ZcIkhUTUxDb2xsZWN0aW9uXCI/ZShjKTpjLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIixmdW5jdGlvbigpe25ldyBoKG4pfSl9fWNhdGNoKGUpe2k9ITAsbz1lfWZpbmFsbHl7dHJ5e3J8fG51bGw9PXMucmV0dXJufHxzLnJldHVybigpfWZpbmFsbHl7aWYoaSl0aHJvdyBvfX19KGYsciksdGhpcy50eXBlLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIixmdW5jdGlvbigpe2UucHJpY2Uuc2V0QXR0cmlidXRlKFwibWluXCIsRVtlLnR5cGUudmFsdWVdKSxlLnByaWNlLnNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsRVtlLnR5cGUudmFsdWVdKX0pLHRoaXMucGlucy5hcHBlbmRDaGlsZChuKX19LHtrZXk6XCJwaW5IYW5kbGVyXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcztyZXR1cm4gZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbigpe3QubWFwLnJlcGxhY2VDaGlsZCh0Lm1hcC5xdWVyeVNlbGVjdG9yKFwiLm1hcF9fY2FyZFwiKSwobmV3IHMpLnJlbmRlcigpKX0pLGUuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIixmdW5jdGlvbihlKXtlLnByZXZlbnREZWZhdWx0KCksdC5tYXAucmVwbGFjZUNoaWxkKHQubWFwLnF1ZXJ5U2VsZWN0b3IoXCIubWFwX19jYXJkXCIpLChuZXcgcykucmVuZGVyKCkpfSksZX19LHtrZXk6XCJiYWNrZW5kXCIsdmFsdWU6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBfKGUsdCkuY2F0Y2goZnVuY3Rpb24oZSl7cmV0dXJuIG4ucmVuZGVyKFwi0J3QtSDRg9C00LDQu9C+0YHRjCDQt9Cw0LPRgNGD0LfQuNGC0Ywg0L7QsdGK0Y/QstC70LXQvdC40Y8uINCe0YjQuNCx0LrQsCBcIi5jb25jYXQoZS5tZXNzYWdlLFwiLiDQn9C+0L/RgNC+0LHRg9C50YLQtSDQv9C10YDQtdC30LDQs9GA0YPQt9C40YLRjCDRgdGC0YDQsNC90LjRhtGDLlwiKSl9KX19XSkmJmcodC5wcm90b3R5cGUsbiksciYmZyh0LHIpLGV9KCkpfV0pOyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=